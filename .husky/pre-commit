#!/bin/sh

# Run shellcheck on shell scripts
# Note: Scripts use zsh, so we run with --shell=bash and filter zsh-specific warnings

# Check if shellcheck is installed
if ! command -v shellcheck >/dev/null 2>&1; then
  echo "âš ï¸  shellcheck not installed, skipping lint check"
  echo "   Install with: brew install shellcheck"
  exit 0
fi

echo "ğŸ” Running shellcheck on scripts..."

# Run shellcheck with specific exclusions for zsh-compatible code
# SC1071 - ShellCheck doesn't support zsh
# SC2296 - zsh-specific parameter expansion syntax
# SC1091 - Not following sourced files
# SC2155 - Declare and assign separately (style preference)
# SC2001 - Use ${var//search/replace} instead of sed (style preference)
# SC2012 - Use find instead of ls (style preference)
# SC2059 - Don't use variables in printf format (style preference)
if ! shellcheck --shell=bash \
  --exclude=SC1071,SC2296,SC1091,SC2155,SC2001,SC2012,SC2059 \
  scripts/*.sh 2>&1; then
  echo "âŒ shellcheck found issues"
  exit 1
fi

echo "âœ… shellcheck passed"
